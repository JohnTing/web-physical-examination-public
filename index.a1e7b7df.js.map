{"mappings":"gRAAO,SAASA,KAQhB,SAAcC,EAAgBC,EAAkBC,EAAmBC,GACjEH,GAAU,IACVC,GAAY,IACZ,IAAIG,EAAaC,EAASC,mBACtBC,EAAWF,EAASG,aAExBJ,EAAWK,QAAQF,GACnBA,EAASE,QAAQJ,EAASK,aAE1BH,EAASI,KAAKC,MAAQZ,EACtBI,EAAWF,UAAUU,MAAQV,EAC7BE,EAAWD,KAAOA,EAElBC,EAAWS,QAEXC,YAAW,WACTV,EAAWW,M,GACVd,E,CAxBHe,CAAK,IAAK,GAAK,IAAK,W,kVCqBtB,IAAAC,EACAC,E,iFArBA,IAAIC,EAAU,GAoBdF,EAlBA,SAAkBG,GAGhB,IAFA,IAAIC,EAAOC,OAAOD,KAAKD,GAEdG,EAAI,EAAGA,EAAIF,EAAKG,OAAQD,IAC/BJ,EAAQE,EAAKE,IAAMH,EAAMC,EAAKE,G,EAelCL,EAXA,SAAiBO,GACf,IAAIC,EAAWP,EAAQM,GAEvB,GAAgB,MAAZC,EACF,MAAM,IAAIC,MAAM,oCAAsCF,GAGxD,OAAOC,C,uCCnBTE,EAAAC,QAAiBC,OAAoB,KAAOC,EAAA,SAAAC,QAA6C,UAAWC,MAAK,IAAMF,EAAc,U,ICA7HA,EAAA,SAAAG,SAA8CC,KAAKC,MAAM,oEHMzD,MAAM/B,EAAW,IAAIgC,aIJrBN,EAAA,SAAwBE,MAAMK,IAC5BC,EAAWD,EAAIE,SACQC,OAAOC,SAASC,eAAe,kBACvCC,YAAc,gBAAgB,IAG/C,IAAIL,EAAW,CAACM,EAAWC,IAClB,IAAIC,SAAiB,KAC1BC,MAAM,qBACC,KAIX,MAAMC,EAAcR,OAAOC,SAASC,eAAe,SAC7CO,EAAUT,OAAOC,SAASC,eAAe,WACzCQ,EAAYV,OAAOC,SAASC,eAAe,SAE3CS,GADaX,OAAOC,SAASC,eAAe,cAC9BF,OAAOC,SAASC,eAAe,gBAC7CU,EAAUZ,OAAOC,SAASC,eAAe,WACzCW,EAAab,OAAOC,SAASC,eAAe,cAC5CY,EAAQd,OAAOC,SAASC,eAAe,SACvCa,EAAaf,OAAOC,SAASC,eAAe,cAG5Cc,EAAShB,OAAOC,SAASC,eAAe,UACxCe,EAAWjB,OAAOC,SAASC,eAAe,YAG1CgB,EAAS,CACb,KAAI,CAAC,QACL,OAAM,CAAC,OAAQ,OAAQ,OAAQ,QAC/B,OAAM,CAAC,OAAQ,QACf,KAAI,CAAC,SAGPrC,OAAOD,KAAKsC,GAAQC,SAAQ,CAACC,EAAGtC,EAAGsB,KACvBc,EAAOE,GASNC,KAAI,CAACD,EAAGtC,EAAGsB,KACpB,IAAIkB,EAASrB,SAASsB,cAAc,UACpCD,EAAOnB,YAAciB,EACrBE,EAAOE,UAAY,kBACnBF,EAAOG,QAAU,KACff,EAAUP,YAAciB,EACxBM,aAAaC,QAAQ,eAAgBjB,EAAUP,YAAY,EAE7DQ,EAAYiB,YAAYN,EAAO,GAjBb,IAGtB,IAAIO,EAAeH,aAAaI,QAAQ,gBAoCxC,SAASC,IACP,GAAI,eAAgB/B,OAAQ,CAC1B,MAAMgC,EAAO,IAAIC,WACjBD,EACGE,OACA1C,MAAK,KACJoB,EAAQT,YAAc,UAEtBgC,EAAI,8BACJH,EAAKI,eAAiB,KACpBD,EAAI,sDAAsD,EAE5DH,EAAKK,UAAaC,IAChBH,EAAI,sBACJA,EAAIG,EAAMC,cAEVzC,EAASwC,EAAMC,aAAc7B,EAAUP,YAAc,IAAIX,MAAMgD,IACzDA,IACFC,EAASH,EAAMC,cACfjF,I,GAEF,CACH,IAEFoF,OAAOC,IACN/B,EAAQT,YAAc,WACtBgC,EAAI,gCAAgCQ,KAAS,G,MAGjD/B,EAAQT,YAAc,WACtBgC,EAAI,2B,CAIR,SAASA,EAAIS,GACXnC,EAAQtC,OAASyE,EAAU,KAC3BnC,EAAQoC,UAAYpC,EAAQqC,aAAerC,EAAQsC,aAE/CtC,EAAQtC,MAAMY,OAAS,MACzB0B,EAAQtC,MAAQsC,EAAQtC,MAAM6E,UAAUvC,EAAQtC,MAAMY,OAAS,K,CAMnE,SAAS0D,EAASQ,EAAcC,EAAkB,IAChD,MAAMC,EAAM,IAAIC,KAChB,IAAIC,EAAWH,GAAWC,EAAIG,WAAa,IAAMH,EAAII,aAAgB,IAAMJ,EAAIK,aAE/ExC,EAAOb,YAAc8C,EACrBhC,EAASd,YAAckD,C,CArFrBxB,IACFnB,EAAUP,YAAc0B,GAgB1BhB,EAAWY,QAAU,KAEnB,GADAgC,QAAQC,IAAI5C,EAAM6C,MAAMC,YACM,UAA1B9C,EAAM6C,MAAMC,WAAwB,CAEvB,SADEC,OAAO,WAAa,MAEnC/C,EAAM6C,MAAMC,WAAa,G,MAG3B9C,EAAM6C,MAAMC,WAAa,QAAQ,EAGrCvF,YAAW,KACTuC,EAAQT,YAAc,aACtB9B,WAAW0D,EAAU,IAAI,GACxB,KAEHvB,EAAYiB,QAAUM,EAwDtBhB,EAAWU,QAAU,KACnBnE,IACAwG,cAHc,GAIJ9D,OAAO3B,YAAW,KAC1BoE,EAAS,IAAK,IAAI,GACjB,IAAK","sources":["src/customAudio.ts","node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-7f4ea8163e670053.js","node_modules/@parcel/runtime-js/lib/runtime-e47bb056f5377db6.js","src/index.ts"],"sourcesContent":["export function bell() {\r\n  beep(100, 0.2, 885, \"triangle\");\r\n  // mySound.play();\r\n}\r\n\r\ntype audioCtxType = \"sine\" | \"square\" | \"sawtooth\" | \"triangle\";\r\nconst audioCtx = new AudioContext();\r\n\r\nfunction beep(volume: number, duration: number, frequency: number, type: audioCtxType) {\r\n  volume /= 100;\r\n  duration *= 1000;\r\n  var oscillator = audioCtx.createOscillator();\r\n  var gainNode = audioCtx.createGain();\r\n\r\n  oscillator.connect(gainNode);\r\n  gainNode.connect(audioCtx.destination);\r\n\r\n  gainNode.gain.value = volume;\r\n  oscillator.frequency.value = frequency;\r\n  oscillator.type = type;\r\n\r\n  oscillator.start();\r\n\r\n  setTimeout(function () {\r\n    oscillator.stop();\r\n  }, duration);\r\n}\r\n","\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","module.exports = (__parcel__import__(\"./\" + require('./helpers/bundle-manifest').resolve(\"7EIhy\"))).then(() => parcelRequire('5toDZ'));","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"1LzKV\\\":\\\"index.a1e7b7df.js\\\",\\\"7EIhy\\\":\\\"firebaseApp.f49ad63e.js\\\"}\"));","import { bell } from \"./customAudio\";\r\n\r\nimport(\"./firebaseApp\").then((app) => {\r\n  pushData = app.pushData;\r\n  const firebaseStatus = window.document.getElementById(`firebaseStatus`) as HTMLDivElement;\r\n  firebaseStatus.textContent = \"載入完畢，連線至資料庫...\";\r\n});\r\n\r\nlet pushData = (a: string, b: string) => {\r\n  return new Promise<boolean>(() => {\r\n    alert(\"firebase 還未載入完畢。\");\r\n    return false;\r\n  });\r\n};\r\n\r\nconst startButton = window.document.getElementById(\"start\") as HTMLButtonElement;\r\nconst logText = window.document.getElementById(\"logText\") as HTMLTextAreaElement;\r\nconst placeText = window.document.getElementById(\"place\") as HTMLSpanElement;\r\nconst testButton = window.document.getElementById(\"testButton\") as HTMLButtonElement;\r\nconst buttonGroup = window.document.getElementById(`buttonGroup`) as HTMLDivElement;\r\nconst nfcText = window.document.getElementById(\"nfcText\") as HTMLSpanElement;\r\nconst pageButton = window.document.getElementById(\"pageButton\") as HTMLButtonElement;\r\nconst pagea = window.document.getElementById(\"pagea\") as HTMLDivElement;\r\nconst startSound = window.document.getElementById(\"startSound\") as HTMLButtonElement;\r\n// const mySound = document.getElementById(\"mySound\") as HTMLAudioElement;\r\n\r\nconst showId = window.document.getElementById(\"showId\") as HTMLHeadElement;\r\nconst showTime = window.document.getElementById(\"showTime\") as HTMLHeadElement;\r\n\r\n\r\nconst places = {\r\n  報到: [\"健檢櫃台\"],\r\n  體檢大樓: [\"基礎檢查\", \"心電檢查\", \"家醫診斷\", \"抽血檢查\"],\r\n  醫療大樓: [\"X光檢查\", \"眼科檢查\"],\r\n  牙科: [\"牙醫檢查\"],\r\n} as Record<string, string[]>;\r\n\r\nObject.keys(places).forEach((v, i, a) => {\r\n  addButton(places[v]);\r\n});\r\n\r\nlet placeSetting = localStorage.getItem(\"placeSetting\");\r\nif (placeSetting) {\r\n  placeText.textContent = placeSetting;\r\n}\r\n\r\nfunction addButton(placeNames: string[]) {\r\n  placeNames.map((v, i, a) => {\r\n    var button = document.createElement(\"button\");\r\n    button.textContent = v;\r\n    button.className = \"btn btn-success\";\r\n    button.onclick = () => {\r\n      placeText.textContent = v;\r\n      localStorage.setItem(\"placeSetting\", placeText.textContent);\r\n    };\r\n    buttonGroup.appendChild(button);\r\n  });\r\n}\r\n\r\npageButton.onclick = () => {\r\n  console.log(pagea.style.visibility);\r\n  if (pagea.style.visibility == \"hidden\") {\r\n    const password = prompt('輸入開發密碼') || \"\";\r\n    if(password == \"1234\") {\r\n      pagea.style.visibility = \"\";\r\n    }\r\n  } else {\r\n    pagea.style.visibility = \"hidden\";\r\n  }\r\n};\r\nsetTimeout(() => {\r\n  nfcText.textContent = \"NFC 啟動中...\";\r\n  setTimeout(startNFC, 500);\r\n}, 500);\r\n\r\nstartButton.onclick = startNFC;\r\n\r\nfunction startNFC() {\r\n  if (\"NDEFReader\" in window) {\r\n    const ndef = new NDEFReader();\r\n    ndef\r\n      .scan()\r\n      .then(() => {\r\n        nfcText.textContent = \"NFC 已啟動\";\r\n        // bell();\r\n        log(\"Scan started successfully.\");\r\n        ndef.onreadingerror = () => {\r\n          log(\"Cannot read data from the NFC tag. Try another one?\");\r\n        };\r\n        ndef.onreading = (event) => {\r\n          log(\"NDEF message read.\");\r\n          log(event.serialNumber);\r\n          // log(event.message.records.map((v, i, a) => {JSON.stringify(v)}).join(\"\\n\"));\r\n          pushData(event.serialNumber, placeText.textContent + \"\").then((success) => {\r\n            if (success) {\r\n              showInfo(event.serialNumber);\r\n              bell();\r\n            }\r\n          });\r\n        };\r\n      })\r\n      .catch((error) => {\r\n        nfcText.textContent = \"NFC 啟動失敗\";\r\n        log(`Error! Scan failed to start: ${error}.`);\r\n      });\r\n  } else {\r\n    nfcText.textContent = \"NFC 啟動失敗\";\r\n    log(\"NDEFReader not in window\");\r\n  }\r\n}\r\n\r\nfunction log(message: string) {\r\n  logText.value += message + \"\\n\";\r\n  logText.scrollTop = logText.scrollHeight - logText.clientHeight;\r\n\r\n  if (logText.value.length > 5000) {\r\n    logText.value = logText.value.substring(logText.value.length - 5000);\r\n  }\r\n}\r\n\r\n\r\n\r\nfunction showInfo(text: string, timeStr: string = \"\") {\r\n  const now = new Date();\r\n  let timeText = timeStr || now.getHours() + \":\" + now.getMinutes()  + \":\" + now.getSeconds()\r\n\r\n  showId.textContent = text;\r\n  showTime.textContent = timeText;\r\n}\r\n\r\nvar timeoutID = -1;\r\nstartSound.onclick = () => {\r\n  bell();\r\n  clearTimeout(timeoutID);\r\n  const a = window.setTimeout(() => {\r\n    showInfo(\" \", \" \");\r\n  }, 5000);\r\n};\r\n\r\n\r\n\r\n"],"names":["$49551748d93adaf2$export$217fdd6335ecce6a","volume","duration","frequency","type","oscillator","$49551748d93adaf2$var$audioCtx","createOscillator","gainNode","createGain","connect","destination","gain","value","start","setTimeout","stop","$49551748d93adaf2$var$beep","$18c11f3350a906ea$export$6503ec6e8aabbaf","$18c11f3350a906ea$export$f7ad0328861e2f03","$18c11f3350a906ea$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","module","exports","import","parcelRequire","resolve","then","register","JSON","parse","AudioContext","app","$b4e14b6b8da86996$var$pushData","pushData","window","document","getElementById","textContent","a","b","Promise","alert","$b4e14b6b8da86996$var$startButton","$b4e14b6b8da86996$var$logText","$b4e14b6b8da86996$var$placeText","$b4e14b6b8da86996$var$buttonGroup","$b4e14b6b8da86996$var$nfcText","$b4e14b6b8da86996$var$pageButton","$b4e14b6b8da86996$var$pagea","$b4e14b6b8da86996$var$startSound","$b4e14b6b8da86996$var$showId","$b4e14b6b8da86996$var$showTime","$b4e14b6b8da86996$var$places","forEach","v","map","button","createElement","className","onclick","localStorage","setItem","appendChild","$b4e14b6b8da86996$var$placeSetting","getItem","$b4e14b6b8da86996$var$startNFC","ndef","NDEFReader","scan","$b4e14b6b8da86996$var$log","onreadingerror","onreading","event","serialNumber","success","$b4e14b6b8da86996$var$showInfo","catch","error","message","scrollTop","scrollHeight","clientHeight","substring","text","timeStr","now","Date","timeText","getHours","getMinutes","getSeconds","console","log","style","visibility","prompt","clearTimeout"],"version":3,"file":"index.a1e7b7df.js.map"}